---
title: "R Notebook"
output:
  html_notebook: default
  pdf_document: default
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

## Data Introduction

```{r}
library(readr)
library(ggplot2)
library(dplyr)

# Load the dataset
df <- read_csv("Placement_Data_Full_Class.csv")

str(df)
head(df)
```

## Data Cleaning

```{r}
# Removing unnecessary columns
college_df <- df %>% select(-sl_no)

# Cleaning up null data
college_df$salary[is.na(college_df$salary)] <- 0

# One Hot Encoding
college_df <- college_df %>% 
  mutate(specialisation_Mkt_Fin = as.integer(specialisation == 'Mkt&Fin'),
         specialisation_Mkt_HR = as.integer(specialisation == 'Mkt&HR'),
         ssc_b_Others = as.integer(ssc_b == 'Others'),
         hsc_b_Others = as.integer(hsc_b == 'Others'),
         hsc_s_Arts = as.integer(hsc_s == 'Arts'),
         hsc_s_Commerce = as.integer(hsc_s == 'Commerce'),
         hsc_s_Science = as.integer(hsc_s == 'Science'),
         degree_t_Comm_Mgmt = as.integer(degree_t == 'Comm&Mgmt'),
         degree_t_Sci_Tech = as.integer(degree_t == 'Sci&Tech'),
         degree_t_Others = as.integer(degree_t == 'Others'))

college_df <- college_df %>% select(-c(specialisation, ssc_b, hsc_b, hsc_s, degree_t))

# Dictionary replacement
college_df$gender <- ifelse(college_df$gender == 'M', 0, 1)
college_df$workex <- ifelse(college_df$workex == 'No', 0, 1)
college_df$status <- ifelse(college_df$status == 'Placed', 0, 1)

```

## Data Visualization

```{r}

# Load necessary packages
library(reshape2)
library(ggplot2)

# Create a correlation matrix
corr_mat <- round(cor(college_df), 2)

# Melt the correlation matrix for plotting
melted_corr_mat <- melt(corr_mat)

ggplot(data = melted_corr_mat, aes(x = Var1, y = Var2, fill = value)) +
  geom_tile(width = 1, height = 1) +
  geom_text(aes(label = value), size = 2) +
  labs(title = "Correlation Heatmap") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

```

### Count Plots 

```{r}

# Gender Count
ggplot(df, aes(x = gender, fill = gender)) +
  geom_bar() +
  geom_text(stat = 'count', aes(label = after_stat(count)), vjust = -0.5) +
  labs(x = 'Gender', y = 'Count') +
  scale_fill_brewer(palette = 'Pastel1')

# Work Experience
ggplot(df, aes(x = workex, fill = workex)) +
  geom_bar() +
  geom_text(stat = 'count', aes(label = after_stat(count)), vjust = -0.5) +
  labs(x = 'Work Experience', y = 'Count') +
  scale_fill_brewer(palette = 'Pastel1')  

# Placement Status
ggplot(df, aes(x = status, fill = status)) +
  geom_bar() +
  geom_text(stat = 'count', aes(label = after_stat(count)), vjust = -0.5) +
  labs(x = 'Placement Status', y = 'Count') + 
  scale_fill_brewer(palette = 'Pastel1')  

# Placement Status by Genders
ggplot(df, aes(x = status, fill = gender)) +
  geom_bar(position = 'dodge') +
  geom_text(stat = 'count', aes(label = after_stat(count)), position = position_dodge(0.9), vjust = -0.5) +
  labs(x = 'Placement Status by Genders', y = 'Count') +
  scale_fill_brewer(palette = 'Pastel1')  
```

### Distribution Plots

```{r}
# Set the plot size
options(repr.plot.width = 15, repr.plot.height = 8)

# Create distribution plots
par(mfrow = c(2, 2))

# Secondary Education percentage
ggplot(df, aes(x = ssc_p)) +
  geom_histogram(binwidth = 5, fill = 'lightblue', color = 'black') +
  labs(x = 'Secondary Education percentage', y = 'Frequency')

# Higher Secondary Education percentage
ggplot(df, aes(x = hsc_p)) +
  geom_histogram(binwidth = 5, fill = 'lightgreen', color = 'black') +
  labs(x = 'Higher Secondary Education percentage', y = 'Frequency')

# Undergraduate percentage
ggplot(df, aes(x = degree_p)) +
  geom_histogram(binwidth = 5, fill = 'lightcoral', color = 'black') +
  labs(x = 'Undergraduate percentage', y = 'Frequency')

# MBA percentage
ggplot(df, aes(x = mba_p)) +
  geom_histogram(binwidth = 5, fill = 'lightsalmon', color = 'black') +
  labs(x = 'MBA percentage', y = 'Frequency')
```

## Logistic Regression

```{r}

```


Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
